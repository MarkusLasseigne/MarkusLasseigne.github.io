<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Bouncing Box</title>
		<script src="jquery.min.js"></script>

		<!-- 	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> -->

		<!-- BEGIN CSS -->
		<style>
			.box {
				background-image: url("https://www.freeiconspng.com/uploads/world-globe-planet-icon-png-11.png");
				background-repeat: no-repeat;
				background-size: 100% 100%;
				background-color: clear;
				border-radius: 100%;
				position: absolute;
				text-align: center;
				user-select: none;
				font-size: 350%;
				display: block;
				cursor: pointer;
				height: 100px;
				width: 100px;
				color: black;
				top: 200px;
				left: 0px;
			}
			.board {
				background-color: clear;
				user-select: none;
				height: 100%;
			}
			/* Win or Lose Prompt */
			#alertBox {
				background-color: black;
				border-radius: 15px;
				margin-right: 75%;
				text-align: left;
				display: none;
				color: white;
				height: 75px;
			}
			.message {
				background-color: #232323;
				border-radius: 10px;            
				margin-bottom: 8px;
				font-weight: bold;
				font-size: 180%;
			}
			.refresh {
				background-color: #232323;
				text-decoration: none;
				border-radius: 5px;
				font-size: 140%;
				cursor: pointer;
				padding: 2px;
				color: white;
			}
			.refresh:hover {
				background-color: white;
				text-decoration: none;
				border-radius: 5px;
				font-size: 140%;
				color: #232323;
				padding: 2px;
			}
		</style>
	</head>
	<body class="board">
		<div id="alertBox">
			<div class="message"></div>
			<a href="https://markuslasseigne.github.io/projects/bouncing-box/" class="refresh">Refresh</a>   
		</div>
    	<!-- HTML for the box -->
		<div class="box">?</div>
	   <!-- BEGIN JAVASCRIPT -->
	<script>
			(function(){
				'use strict'
				/* global jQuery */
				// jQuery stuff setup for you
				var box = jQuery('.box');
				board = jQuery('.board');
				boardWidth = window.innerWidth * 0.99;
				var boardHeight = window.innerHeight * 0.99; 
				board.css = board;

    			// Variable declarations 
				var position;
				position = 50;

				var positionY;
				positionY = 50;

				var direction;
				direction = 1;

				var directionY;
				directionY = 1;

				var speed;
				speed = 4;

				var points;
				if (points < 0){
					points = 0;
					points = 0;
				}

				var miss;
				if (miss < 0){
					miss = 0;
					miss = 0;
				}

				box.css('left', position);
				box.css('top', positionY);
				box.text(points);

				function update() {
					position += speed * direction;
					positionY += speed * directionY;
					boardHeight = window.innerHeight * 0.99; 
					boardHeight = window.innerHeight * 0.99;
//    				 console.log(speed);
//                     console.log("X position: " + position);
//                     console.log("Y position: " + positionY);
					if(position > boardWidth) {
					direction = -0.8;
					console.log("Right Wall Hit");
					console.log("X" + direction);
				}
				if(position < 5){
					direction = +0.8;
					console.log("Left Wall Hit");
					console.log("X+" + direction);
				}
				if(positionY < 4){
					directionY = +0.8;
					console.log("Top Wall Hit");
					console.log("Y+" + directionY);
				}
				if(positionY > boardHeight){
					directionY = -0.8;
					console.log("Bottom Wall Hit");
					console.log("Y" + directionY);
				}
				box.css('left', position);
				box.css('top', positionY);
			}
			function handleBoxClicked() {
				var directX = Math.random() < 0.5 ? -1 : 1;
				var directY = Math.random() < 0.5 ? -1 : 1;				 
				if (points < 0) {
					points = 0;
					points += 2;
					miss -= 2;
				}
				if (miss < 0) { 
					miss = 0;
				}
				if (speed <= 0) {
					speed = 1.5;
					speed += 2;
				}
				if (speed <= 0) speed = 1.5;
    				direction = directX;
    				directionY = directY;
    				box.text(points);
        			console.log(points + " Got");
    			}
			function handleBoxMiss(){
				if (miss < 0){
					miss = 0;
					miss += 1;
					points -= 1;
				}
				if (points < 0){ 
					points = 0;
				}
				if (speed <= 0){
					speed = 1.5;
					speed -= 1.5;
				}
				if (speed <= 0){
					speed = 1.5;
				}
				console.log(miss + ' missed');
				box.text(points);
			}
			function doAlert(msg, reText){
				var alertBox = $("#alertBox");
				alertBox.find(".message").text(msg);
				alertBox.find(".refresh").unbind().click(function(){
					alertBox.hide();
				});
				alertBox.find(".refresh").click(reText);
				alertBox.show();
				clearInterval(interval);
			}
			var endCheck = setInterval(endGame, 30);
			function endGame(){
				if(points > 9.9){
					doAlert("Congrats You Won! Again?");
					points = 10;
					miss -= -5;
					box.hide();
					return clearInterval(interval);
				}
				if(miss > 13.9){
					doAlert("You've Lost, Try Again?");
					points = -14;
					miss = 13;
					box.hide();
					return clearInterval(interval);
				}
			}

			var interval = setInterval(update, 16);

			box.click(handleBoxClicked);
			box.dblclick(handleBoxClicked);
			board.click(handleBoxMiss);

			})();
		</script>
	</body>
</html>
